function dy = calculate_ByTheta(u_m,Theta,A_m,f1,f2,mu,kappa)
F = (0.75+0.75*kappa*sqrt(u_m/A_m)+2*u_m^2*(f1*(1-cos(Theta(1)))+f2*mu^2*(1-cos(Theta(3)))))...
    /(0.75-u_m^2*(f1*Theta(2)^2+f2*Theta(4)^2));
C = 1/F;

     dy = zeros(4,1); % a column vector
     dy(1) = Theta(2);
     dy(2) = -Theta(2)/u_m*(5/2-2*u_m^2*(f1*Theta(2)^2+f2*Theta(4))-...
         (1+3/4*kappa*(u_m./A_m).^(1/2))*C)...
         -sin(Theta(1))*C;
     dy(3) = Theta(4);
     dy(4) = -Theta(4)/u_m*(5/2-2*u_m^2*(f1*Theta(2)^2+f2*Theta(4))-...
         (1+3/4*kappa*(u_m./A_m).^(1/2))*C)...
         -mu^2*sin(Theta(3))*C;
